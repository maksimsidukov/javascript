<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Задание 2</title>
	<script src = 'phones.js'></script>
	<style>
		body{
			margin: 0 auto;
			text-align: center;
			width: 85%;
		}
		.phone{
			margin: 0 auto;
			width: 20%;
			padding: 10px;
			float: left;
		}
	</style>
</head>
<body>
	<div id='basket'>
		<h1>Корзина</h1>
	</div>
	<hr>
	<div id='phones'></div>
</body>
</html>
<script>
	var divPhones = document.getElementById('phones');
	var divBasket = document.getElementById('basket');
	var id = 0;
	var goods = [];
	var prices = 0;
	for(phone of phones){
		var ph = document.createElement('div');
		ph.className = 'phone';
		phoneImg = '<img src="'+phone.img+'"></img>';
		phoneName = '<p>'+phone.name+'</p>';
		phonePrice = '<p>'+phone.price+' руб</p>';
		button = document.createElement("button");
		button.addEventListener('click', buy);
		button.innerText = 'Купить';
		button.id = id;
		ph.innerHTML=phoneImg+ phoneName+phonePrice;
		ph.appendChild(button)
		divPhones.appendChild(ph);
		id++;
	}
	for(phone of goods){
		prices += phone.quantity * phone.prices
		divBasket.innerHTML += '<p> Общая стоимость '+prices+' рублей<>'
	}
	function buy(e){
		var i = e.target.id;
		//console.log(e.target.id);
		phone = phones[i];
		if (!inBasket(phone)){
			phone.quantity = 1;
			goods.push(phone);
			prices += phone.price;
			basket();
		}
		else{
			goods[inBasket(phone)].quantity++;
			prices += phone.price;
			basket();
		}
		//console.log(prices)
	}
	function inBasket(arg){
		if(goods.length === 0){
			return false;
		}
		for (idx in goods){
			if (goods[idx].name === arg.name){
				return idx;
			}
		}
		return false;
	}
	function basket(){
		console.log(prices);
		divBasket.innerHTML = '';
		divBasket.innerHTML += '<h1>Корзина</h1>'
		for (i of goods){
			var x = document.createElement('div');
			divBasket.innerHTML += '<p>'+i.name+' Количество '+i.quantity+' Цена '+(i.price*i.quantity)+'</p>';
		}
		divBasket.innerHTML += '<h4>Общая стоимость '+prices+' рублей</h4>'
	}
</script>